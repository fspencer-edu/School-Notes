
- Network applications
	- Streaming video and VoIP
- Application deployment
	- TCP
	- UDP
- Socket interface
- Client-server applications

## Principles of Network Applications

### Network Application Architectures

- Network application development is writing programs that run on different end systems and communicate with each other over the network

<img src="/images/Pasted image 20251212182615.png" alt="image" width="500">

- From application development, the network architecture is fixed and provides a specific set of services to applications
- Application architecture is designed by the application developer and dictates how the application is structured

- 2 Methods
	- Client-server
	- Peer-to-peer architecture

- Client-server architecture
	- Server is an always on host that services requests from the clients
	- Web server
	- Clients do no directly communicate with each other
	- Server has a fixed address (IP)
	- A client can always contact server
	- FTP
	- Telnet
	- Email
	- Single-server host is incapable of keeping up will all requests

- Data centres house large number of hosts to hand requests

- P2P architecture
	- Minimal or no reliance on dedicated servers in data centres
	- Applications uses direct communication between pairs of intermittently connected hosts, called peers
	- Most of today's popular and traffic-intensive applications
	- File sharing
	- Self-scalability
		- Each peer also adds service capacity to the system by distributing files to other peers
	- Cost effective
	- Decentralized structure


<img src="/images/Pasted image 20251212183127.png" alt="image" width="500">



### Processing Communicating

- A process is a program that is running within an end system
- Communicate with each other with interprocess communication
- Processes communicate with exchanging messages

**Client and Server Processes**
- A process can be both a client and server
- Process that initiates the communication is labeled the client
- The process that waits to be contacted to begin the session is the server

**Interface Between the Process and the Computer Network**
- The network through a software interface is called a socket
- Application Programming Interface (API) is the socket interface between the application layer and transport layer
- Application developer has control of everything on the application layer side, but little control of transport-layer
	- Choice of transport protocol
	- Ability to fix a few transport-layer parameters such as maximum buffer and max segment sizes

<img src="/images/Pasted image 20251212183815.png" alt="image" width="500">

**Addressing Processes**
- 2 pieces of information
	- Address of host
	- Identifier that specifies the receiving process in destination host

- Host is identified by its IP address
	- 32-bit number that uniquely identifies host
- A destination port number is used to identify receiving process
- Web server is identified by port number 89
- Mail server (SMTP) uses port 25


### Transport Services Available to Applications

- Transport layer protocol is responsible for getting messages to the socket of the receiving process

**Reliable Data Transfer**
- A packet can overflow a buffer in a router
- Can be discarded by a host or router for corrupted bits
- Process-to-process reliable data transfer, passes data into the socket with complete confidence that data will arrive without errors
- Loss-tolerant applications, such as multimedia has some amount of data loss

**Throughput**

- Other sessions share the bandwidth along the network path, the available throughput can fluctuate with time
- If the transport protocol cannot provide throughput, application needs to encode at a lower rate or give up half of data
- Applications have requirements that are bandwidth-sensitive
- Elastic applications can make use of as much, or as little, throughput available

**Timing**
- A transport-layer protocol can also provide timing guarantees
- Real-time application
- Telephone
- Virtual environments
- Multiplayer games

**Security**
- A transport protocol can encrypt all data transmitted by the sending process
- Receiving host decrypts data
- Also provide confidentiality, including data integrity and end-point authentication

### Transport Services Provided by the Internet

<img src="/images/Pasted image 20251212185112.png" alt="image" width="500">


**TCP Services**
- The TCP service model includes a connection-oriented service and a reliable data transfer service
- Connection oriented service
	- Client and server transport layer control information before application level message flow
	- Handshaking allows to prepare for packet transfer
	- TCP connection exists between the sockets of the two processes
	- Full-duplex connection
		- Can send messages over the same connection at the same time
	- Application tears down connection when finished
- Reliable data transfer service
	- TCP delivers all data send without error and in proper order
- Congestion control mechanisms

**UDP Services**
- Lightweight transport protocol
- Minimal services
- Connectionless, no handshaking before processes communicate
- Unreliable data transfer service
- No guarantee for message arrival
- No congestion control mechanism

#### FOCUS ON SECURITY

- Neither TCP or UDP provides encryption
- Applications use secure sockets layer (SSL)
- TCP-enhanced-with-SSL provides critical process-to-process security
	- Encryption
	- Data integrity
	- End-point authentication
- SSL has its own socket API

**Services Not Provided by Internet Transport Protocols**
- TCP is primarily used because is provide reliable data transfer, and guaranteed delivery
- Phone use UDP, circumventing TCP congestion control mechanism and packet overheads
	- Use TCP as backup

<img src="/images/Pasted image 20251212185730.png" alt="image" width="500">

### Application-Layer Protocols

- An application layer protocol define how an application's processes, running on different end systems, pass messages to each other

Defines:
- Types of messages exchanged
- Syntax
- Semantics
- Rules for determining when and how a process sends messages and responds

- Some application layer protocols are specified in RFCs and are public domain
	- HTTP

### Network Applications Covered in This Book

- Applications
	- Web
	- Mail
	- Directory service video streaming
	- P2P

## The Web and HTTP

- The Web was the first internet application in the general public
- Web operates on demand
- Hyperlinks and search engines help to navigate

### Overview of HTTP

- HyperText Transfer Protocol (HTTP), the Web's application-layer protocol, is the heart of the Web
- Client and server program, execute on different end systems
	- Talk to each other by exchanging HTTP messages
- A Web page consists of objects
- An objects is simply a file that is addressable by a single URL
	- HTML
	- Images
	- Java applet
	- Video clip
	- Most web pages consist of a base HTML file and referenced objects

`http://www.google.com/images/picture.gif`

- Web browsers implement the client side of HTTP
- Web servers implement the server side of HTTP
	- Apache
	- Microsoft Internet Information Server
- HTTP uses TCP

<img src="/images/Pasted image 20251212190525.png" alt="image" width="500">

- Server sends requested files to client without storing any state information about the client
	- Server resends the objects
- HTTP is a stateless protocol
- A Web server is always on, with a fixed IP address

### Non-Persistent and Persistent Connections

- Non-persistent connections
	- Request-response pair over a separate TCP connection
- Persistent connections
	- Requests-response at the same time

- HTTP uses persistent connections in its default mode

**HTTP with Non-Persistent Connections**
- Base HTML with 10 image

1) HTTP client process initiates a TCP connection to the server on port 80
2) The HTTP client sends an HTTP request message to the server via its socket
	1) Request message include path name
3) HTTP server process receives the request message
	1) Retrieves the objects from storage, encapsulates it, and responds with a message to client
4) HTTP server tells TCP to close TCP connection
5) HTTP client receives the response message
	1) TCP connection terminates
6) First four steps are repeated for each references image object

- Browsers interpret the data differently
- HTTP specifications define only the communication protocol between the client and server
- Most browsers ope 5 to 10 parallel TCP connections, that handles one request-response transaction
- Round-trip time (RTT), is the time it takes for a small packet to travel from client to server and then back to client
- RTT
	- Packet-propagation delays
	- Packet queuing delays
	- Packet-processing delays
- To open a link there is a three-way handshake
	- Client sends a small TCP segment to the server
	- Server responds with a small TCP segment
	- Client acknowledges back to the server

<img src="/images/Pasted image 20251212192721.png" alt="image" width="500">

**HTTP with Persistent Connections**
- Non-persistent connections challenges
	- New connection is needed and maintained for each requested object
	- TCP buffers must be allocated
	- TCP variables must be kept in both client and server
	- Object suffers a delay delivery of 2 RTT
		- One to establish connection
		- One to request and receive an object
- Persistent connections, the server leaves the TCP connection open after sending a response
- Subsequent requests and responses can be send through the same connection
- Requests for objects can be made back-to-back, without replies
- HTTP server closes a connection when not used for a certain time
- Default mode of HTTP uses persistent connections with pipelining
- HTTP/2 builds on HTTP 1.1 allowing multiple requests and replies to be interleaved in the same connection

### HTTP Message Format

2 Types of HTTP Messages
- Request messages
- Response message

**HTTP Request Message**

```c
GET /dir/page.html HTTP/1.1
Host: www.google.com
Connection: close
User-agent: Mozilla/5.0
Accept-language: fr
```

- Message is written in ASCII text
- First line is the request line
- Other lines are called the header lines
- 3 fields
	- Method field
		- GET
		- POST
		- HEAD
		- PUT
		- DELETE
	- URL field
	- HTTP version
- The header line specifies the host on which the object resides
- `close` tells the server that it is a non-persistent connection

<img src="/images/Pasted image 20251212193543.png" alt="image" width="500">


- `POST`
	- To send entity body with user entered form fields
- The `HEAD` method is similar to `GET` method
	- Responds with an HTTP message, but leaves out the requested object
	- Used for debugging
- `PUT` method is used in conjunction with Web publishing tools
	- Upload an object to a specific path
- `DELETE`
	- Allows a user, or an application, to delete an object

**HTTP Response Message**
```c
HTTP/1.1 200 OK
Connection: close
Date: Tue, 18 Aug 2015 15:44:04 GMT
Server: Apache/2.2.3 (CentOS)
Last-Modified: Tue, 18 Aug 2015 15:11:03 GMT
Content-Length: 6821
Content-Type: text/html
(data data data data data ...)
```
- 3 sections
	- Status line
		- Protocol version v=field
		- Status code
		- Status message
	- 6 header lines
	- Entity body

Common Status Code
- `200 OK`
	- Request succeeded and the information is returned in the response
- `301 Moved Permanently`
	- Request object has been moves, at a different URL
- `400 Bad Request`
	- Generic error code
- `404 Not Found`
	- The requested document does not exist on this server
- `505 HTTP Version Not Supported`
	- Requested HTTP protocol version is not support by server


<img src="/images/Pasted image 20251212194056.png" alt="image" width="500">

- HTTP specification defines many more header lines
- A browser will generate header lines as a function of the browser type and version
	- The user configuration of the browser
	- Browser has a cached, out of date, version of the object


### User-Server Interaction: Cookies

- HTTP server is stateless
- Web servers handle simultaneous TCP connections
- HTTP uses cookies to identify users
- 4 components
	- Cookie header in the HTTP response message
	- Cookie header line in the HTTP request message
	- Cookie file kept on the user's end system and managed by browser
	- Back-end database at web site

- Amazon Web server will create a unique identification number in the back-end database that is indexed by the identification number
- Server responds to a browser, including the HTTP response with a `Set-cookie` header, that contains the identification number

<img src="/images/Pasted image 20251212194632.png" alt="image" width="500">


### Web Caching

- A web cache also called a proxy server is a network entity that satisfies HTTP requests form the origin web server
- Contains a disk storage and keeps copies of recent requested objects

1) Browser established a TCP connection to the web cache and sends an HTTP request to the web cache
2) Web cache returns cached objects to client
3) If web cache does not have object, it opens a TCP connection to origin server
4) Web cache then stores a copy of the object to its local storage

- Web cache is purchased and installed by an ISP
- Reduces the response time for a client request
- Reduce traffic on an institution's access link to the internet
	- Improves performance for all applications

<img src="/images/Pasted image 20251213163022.png" alt="image" width="500">

<img src="/images/Pasted image 20251213163148.png" alt="image" width="500">


- The total response time, from request to object received, is the sum of the LAN delay, access delay, and internet delay
- Content Distribution Networks (CDNs), web caches are increasingly used in the internet
	- Installs distributed caches throughout the internet

**The Conditional GET**
- Caching introduces stale objects
- Conditional GET is a request message
	- GET method
	- Includes `If-Modified-Since` header line

- Cache performs an up-to-date check by issuing a conditional GET

```c
GET /fruit/kiwi.gif HTTP/1.1
Host: www.exotiquecuisine.com
If-modified-since: Wed, 9 Sep 2015 09:23:24
```

- Header line is equal to the `Last-Modified` header line
- If the most updated, the server sends a message without the body
	- `304 Not Modified`


## Electronic Mail in the Internet

- User agents
	- Allows users to read, reply to, forward, save, and compose messages
	- Microsoft Outlook
	- Apple Mail
- Mail servers
	- Message is placed in an outgoing queue
- Simple Mail Transfer Protocol (SMTP)

<img src="/images/Pasted image 20251213163856.png" alt="image" width="500">

- If the server cannot deliver mail to recipient, the sender's server holds the message in a message queue
- Reattempts are done every 30 minutes
- SMTP is the principal application-layer protocol for Internet electronic mail
- 

### SMTP

- Original SMTP RFC dates back to 1982
- Restricts the body of all mail messages to simple 7-but ASCII
- Binary multimedia data to be encoded to ASCII before being sent over SMTP
- TCP connection is a direct connection between the two servers

<img src="/images/Pasted image 20251213234857.png" alt="image" width="500">

- SMTP has TCP establish a connection to port 25 at the server
- When connection is established, performs an application layer handshake
- Reliable data transfer

5 Commands
1) `HELO`
2) `MAIL FROM`
3) `RCPT TO`
4) `DATA`
5) `QUIT`

- Message ends with `CRLF.CRLF`
	- For carriage return and line feed
- SMTP uses persistent connections
	- Send messages over the same TCP
- Use Telnet to carry out a direct dialogue with an SMTP server

### Comparison with HTTP

- Both protocols are used to transfer files
- HTTP
	- Pull protocol
	- Loads information on a Web server
	- Users pull information from server
	- TCP is initiated by machine that wants to receive the file
	- Encapsulates each object in its owns HTTP response message
- SMTP
	- Push protocol
	- Sending mail server pushed file to receiving mail server
	- TCP connection is initiated by sender
	- Message's objects are put into one message

### Mail Message Formats

**Typical Message Header in SMTP**
```c
From: alice@crepes.fr
To: bob@hamburger.edu
Subject: Searching for the meaning of life.
```

### Mail Access Protocols

- A typical user runs a user agent on the local PC, but accesses the mailbox on an always-on shared mail server
- The sender's agent user pushes message into mail server
- Mail server uses SMTP to relay message to recipients mail server

<img src="/images/Pasted image 20251213235927.png" alt="image" width="500">

- Transfer messages from mail server to local device
- Mail access protocols
	- Post Office Protocol - Version 3 (POP3)
	- Internet Mail Access Protocol (IMAP)
	- HTTP

**POP3**
- Simple mail access protocol
- Client user agent opens a TCP connection to the mail server (server) on port 110
	- Authorization
		- Username and password
	- Transaction
		- Retrieves messages
		- Statistics
	- Updates

- Server responds with a reply
	- `+OK`
	- `-ERR`

```c
telnet mailServer 110
+OK POP3 server ready
user bob
+OK
pass hungry
+OK user successfully logged on
```

- Transaction commands
	- `list`
	- `retr`
	- `dele`

- User agent asks mail server to list size of each message
- Download-and-delete mode partitions mail messages over machines
- Maintains state information

**IMAP**
- POP3 does not provide any means for a user to create remove folders and assign messages to folders
- Associate each message with a folder
	- INBOX
- Search remove folders
- Maintains user state across IMAP sessions
- Obtain components of messages

**Web-Based E-Mail**

- Web-based email is provided by Google, Yahoo
- Uses HTTP protocol rather than POP3 or IMAP

## DNS - The Internet's Directory Service

- Hostnames are mnemonics for IP addresses
- Endings indicate country codes or institutions
- Consists of 4 bytes
- Hierarchical
	- Scan from left to right, reveals more specific information

### Services Provided by DNS

- Domain mame system (DNS)
	- Distributed database implemented in a hierarchy of DNS servers
	- An application layer protocol that allows hosts to query the distributed database
- UNIX machines running the Berkeley Internet Name Domain (BIND) software
- Runs over UDP and uses port 53
- DNS is used by HTTP and SMTP to translate hostnames to IP addresses
- The desired IP is often caches in a nearby DNS server

Other DNS Services
- Host aliasing
- Mail server aliasing
- Load distribution
	- Replicate web servers
	- A set of IP addresses running with one canonical hostname

#### PRINCIPLES IN PRACTICE

- DNS protocol is an application layer protocol
	- Runs between communicating end systems using the client-server paradigm
	- Relies on a underlying end-to-end transport protocol to transfer DNS messages


### Overview of How DNS Works

- `gethostbyname()`

**Problems with a Centralized DNS**
- A single point of failure
- Traffic volume
- Distant centralized database
- Maintenance

**A Distributed, Hierarchical Database**
- DNS uses a large number of servers, organized in a hierarchical fashion
- 3 classes of DNS servers
	- Root
	- Top-level domain (TLD)
	- Authoritative

<img src="/images/Pasted image 20251214203738.png" alt="image" width="500">

- Client contacts one of the root servers, which returns IP addresses for TLD servers for top-level domain
- Client then contacts on of the TLD servers, which returns the IP address for an authoritative server

- Root DNS servers
	- Over 400
	- Managed by 13 organizations
- Top-level domain (TDL) servers
	- com, org, net, edu, gov
	- Country-top level domains
		- uk, fr, ca, jp
	- Verisign Global Registry Services maintains the TLD servers for com domain
	- Educause for edu
- Authoritative DNS servers
	- Organization's authoritative DNS server houses DNS records


- Local DNS server
	- Residential ISP
	- Institutional ISP
- ISP provides the host with the IP addresses of one or more of its local DNS servers (DHCP)
- When a host makes a DNS query, the query is sent to the local DNS server, which acts as a proxy, forwarding the query into the DNS server hierarchy

<img src="/images/Pasted image 20251214204611.png" alt="image" width="500">

- This example uses recursive queries and iterative queries
- `dns.nyu.edu` asks `cse.nyu.edu` to obtain the mapping on behalf of itself

<img src="/images/Pasted image 20251214204803.png" alt="image" width="500">

**DNS Caching**
- DNS exploits DNS caching in order to improve the delay performance and to reduce the number of DNS messages
- When a DNS receives a reply, it can cache the mapping in its local memory
- If a hostname/IP is cached in a DNS server and other query arrives to the DNS server for that hostname, the DNS can provides the IP
- DNS servers discard cached information after a period of time
- Root servers are often bypassed for all but a very small fraction of DNS queries

### DNS Records and Message

- DNS servers store resource records (RRs)
	- Hostname-to-IP mappings

- A RR is a 4-tuple that contains the following fields
```c
(Name, Value, Type, TTL)

(relay1.bar.foo.com, 145.37.93.126, A)
```

- `TTL` is the time to live of the resource record
- `Type=A`
	- Then `Name` is a host name and `Value` is the IP address for the hostname
- `Type=NS`
	- Then `Name` is a domain and `Value` is the hostname of an authoritative DNS server
	- Route DNS queries further along in the query chain
- `Type=CNAME`
	- Then `Value` is a canonical hostname for the alias hostname `Name`
- `Type=MX`
	- Then `Value` is the canonical name of a mail server than has an alias hostname `Name`

**DNS Messages**
- Only 2 kinds of DNS messages
- Both query and reply messages have the same format
- First 12 bytes is the header seconds
	- First field is a 16 bit number that identifies the query
		- 1-bit query flag indicates whether the message is a query (0) or reply (1)

<img src="/images/Pasted image 20251214205603.png" alt="image" width="500">

- nslookpu program
	- Sends a DNS query to any DNS server
	- Display the records included in the replay

**Inserting Records into the DNS Database**
- Register a domain name with a registrar
- A registrar is a commercial entity that verifies the uniqueness of the domain name, and enters it into the DNS database
- Network Solutions was the sole registrar
- Internet Corporation for Assigned Names and Numbers (ICANN) accredits the various registrars
- Provides the registrar with IP addresses of primary and secondary authoritative DNS servers


```c
// Authoritative DNS
dns1.networkutopia.com - 212.2.212.1
dns2.networkutopia.com - 212.212.212.2

// Record
(networkutopia.com, dns1.networkutopia.com, NS)
(dns1.networkutopia.com, 212.212.212.1, A)
```

- A Type NS and A records are entered into the TLD com servers

#### FOCUS ON SECURITY

- DDoS bandwidth-flooding attach against DNS servers
	- An attacker could attempt to send to each DNS root server a deluge of packets
	- Botnet of ICMP ping messages
- DNS queries to top-level domain servers
	- Harder to filter DNS queries directed to DNS servers
- Man-in-the-middle attack
	- The attacker intercepts the queries form the host and returns bogus replies
- DNS poisoning attack
	- Attacker send bogus replies to the DNS server, tricking the server into accepting bogus records into its cache


## Peer-to-Peer Applications

### P2P File Distribution

- Minimal to no reliance on always-on infrastructure servers
- Pair of connected hosts communicate directly with each other
- Distributing a large file from a single server to a large number of hosts
- In client-server file distribution, the server sends a copy of the file to each peer
- In P2P file distribution, each peer can redistributed any portion of the file to peers
- Most popular P2P file distribution protocol is BitTorrent

**Scalability of P2P Architectures**

$u_s$ = upload rate of server's
$u_i$ = upload rate of ith peer
$d_i$ = download rate of ith peer

$F$ = size of files (bits)
$N$ = number of copies

- The distribution time is the time it takes to get a copy of the file to all $N$ peers

<img src="/images/Pasted image 20251214211049.png" alt="image" width="500">


- Client-server architecture, $D_{CS}$
	- Server transmits one copy of the file to each of the $N$ peers
	- Transmits $NF$ bits
	- Time to distribute the file is at least $NF/u_S$
	- $d_{min}$ is the download rate of the peer with the lowest download rate

$D_{cs}≥max({NFu_s,Fd_{min}})$

- Lower bound on the minimum distribution time for the client-server architecture
- Distribution time increases linearly with the number of peers $N$

- P2P architecture
	- Each peer can assist the server in distributing the file
	- Depends on how each peer distributes portion of the file to other peers
	- Only the server has the file at the beginning
	- Server send each bit of file into its access link at least once
	- Minimum distribution is $F/u_s$

$D_{P2P}≥max{Fu_s,Fd_{min},NFu_s+∑i=1Nu_i}$

- Each peer can redistribute a bit as soon as it receives the bit, then there is scheme that achieves this lower bound
- In reality, chunks of the file are redistributed rather than individual bits

<img src="/images/Pasted image 20251214211851.png" alt="image" width="500">

- A peer can transmit the entire file in one hour, the server transmission rate is 10 times the peer upload rate
- For client-server architecture, the distribution time increases linearly and without bound as the number of peers increases
- In P2P, the minimal distribution time is not only always less than distribution time of the client-server, it is also less than one hour for any number of $N$ peers
	- Self-scaling

**BitTorrent**
- Popular P2P protocol for file distribution
- The collection of all peers participating in the distribution of a file is called a torrent
- Peers in a torrent download equal-size chunks of the file form one another (~256 Kbytes)
- Accumulates chucks
	- Downloads and uploads to peers at the same time
- Once a peer has acquire the entire file, it can leave the torrent, or remain and upload to other peers

<img src="/images/Pasted image 20251214212259.png" alt="image" width="500">

- When a peer joins a torrent, it registers itself with the tracker and periodically informs the tracker that it is still in the torrent
- Tracker keeps track of peers that are participating in the torrent
	- Fewer than 10 or no more than 1000 peers participating

Tit-for-Tat
- A joining torrent, will know what they have, and what their neighbours have
	- The rarest first is when a torrent sends a request chuck
	- The chunks that are the rarest among the neighbours is chosen and then requests
	- Rare chunks then get more quickly redistributed, to equalized the number of copies
- Torrent gives priority to the neighbours that are currently supplying the highest rate
- Reciprocates by sending chunks to the same four peers
- Recalculates every 10 seconds
	- 4 peers are unchoked
- Every 30 seconds, picks up an additional random neighbour, referred to as optimistically unchoked
- The effect is that peers capable of uploading at compatible rates tend to find each other
- Other BitTorrent mechanisms
	- Pieces (mini-chunks)
	- Pipelining
	- Random first selection
	- Endgame mode
	- Anti-snubbing

- Another P2P, Distributed Hast Table (DHT)
	- A simple database, with the database records being distributed over the peers in the P2P system


## Video Streaming and Content Distribution Networks

### Internet Video

- Underlying medium of streaming is stored video
- Compressed Internet video ranges from 100 kpbs for low-quality to over 3 Mbps for high definition
- 4K streaming has a bitrate of more than 10 Mbps
- The network must provide an average throughput to the streaming application

### HTTP Streaming and DASH

- In HTTP streaming, the video is stored at an HTTP server at a URL
- On the client side, the bytes are collected in a client application buffer
- When buffer exceed per-determined threshold, its begins to play
- All clients receives the same encoding of the video
- New type of HTTP-based streaming, Dynamic Adaptive Streaming over HTTP (DASH)
	- The video is encoded into several different versions with different bit rates
	- Allows clients with different internet access to stream video
	- Adapts to the available bandwidth
	- Video is stored in the HTTP server
	- Also has a manifest file, which provides a URL for each version along with the bit rate

### Content Distribution Networks

- Content Distribution Networks (CDNs)
- Manages servers in multiple geographically distributed locations
- Stores copies of videos, and directs each user request to a CDN location
- CDN may be private CDN
	- Google
- Third party
	- Limelight

- CDNs adopt one of the two different server placement philosophies
1) Enter deep
	1) Develop server clusters in access ISPs all over the world
	2) Get closer to end users, to improve user-perceived delay
	3) Decrease the numbers of links and routers between end user and the CDN user
2) Bring home
	1) Place clusters at smaller Exchange Points (IXPs)
	2) Results in lower maintenance and management overhead

- CDN replicates content across its clusters
- CDNs do not push videos to their clusters, but instead use a simple pull
	- If a client requests a video from a cluster that is not storing it, then the cluster retrieves the video and stores it

**CDN Operation**

#### GOOGLE'S NETWORK INFRASTRUCTURE

- Google has deployed an extensive private network and CDN infrastructure
- 3 tiers of server clusters
	- 14 mega data centres
	- 50 clusters in IXPs
	- Hundreds of enter-deep clusters within an access ISP

- A query is therefore sent to
	- Local ISP
	- Nearby enter-deep cache
	- Nearby cache also forwards query to private network to data centre
	- Page is send to nearby enter-deep cache
		- Advertisements come from surrounding data centres

- Most CDNs take advantage of DNS to intercept and redirect requests

**Cluster Selection Strategies**
- Core of CDN deployment is a cluster selection strategy
- Mechanisms for dynamically directing clients to a server cluster or a data centre within the CDN
- CDN learns the IP address of the client's LDNS server
- Geographically closest
	- Strategy ignores the variation in delay and available bandwidth over time of internet paths
- Real-time measurements of delay and loss performance are measures between clusters and clients
- CDNs can have each of its cluster periodically sends probes to all of the LDNSs

### Case Studies: Netflix, YouTube, and Kankan

**Netflix**

2 Major Components
- Amazon Cloud
	- Content ingestion
	- Content processing
	- Uploading versions to its CDN
- Private CDN infrastructure
	- User registration
	- Cataloguing

<img src="/images/Pasted image 20251214220046.png" alt="image" width="500">

- Netflix does not use pull-caching to populate its CDN servers in the IXPs and ISPs
- Instead, Netflix distributed by pushing the videos to its CDN servers during off-peak hours
- Netflix pushes only the most popular videos, determined on a daily basis
- Netflix does not need to employ DNS redirect to connect to a particular client to a CDN server
- Netflix software directly tells the client to use a particular CDN server
- Netflix uses push caching rather than pull
	- Content is pushed into servers, rather than dynamically during cache misses

**YouTube**
- Google uses pull caching, and DNS redirect
- Directs the client to the cluster for which the RTT between the client and cluster is the lowest
- To balance the load, sometimes the client is directed (via DNS) to a more distance cluster
- Does not use adaptive streaming (DASH), instead requires the user to select version
- Uses HTTP byte range request to limit the flow of transmitted data
- Videos are uploaded and processed in Google data centres

**KanKan**
- KanKan has been deploying P2P video delivery
- Video streaming is similar to BitTorrent file downloading
- Kankan has migrated to a hybrid CDN-P2P streaming system
- Deploys a few hundred servers within Chine and pushes video content to these servers
- When total P2P traffic is sufficient for video playback, the client will cease streaming from CDN
- If traffic becomes insufficient, client will restart CDN connections

## Socket Programming: Creating Network Applications

- Two types of network application
	- Protocol standard
		- RFC
		- "Open" application
		- Google chrome browser communicating with an Apache Web server
	- Proprietary network application
		- Protocol that has not been openly published in an RFC

- TCP is connection oriented and provides a reliable byte-stream channel through which data flows between two end systems
- UDP is connectionless and sends independent packets of data from one eny system to the other

### Socket Programming with UDP

- Write a client-server program that use UDP
- First attach a destination address to the packet
- The receiving process will retrieve the packet through the socket
- When a socket is created, an identifier, called a port number, is assigned to it
- Packet's destination address also includes the socket's port number
- Attaching the source address is done by the underlying OS

Socket Programming for Both UDP and TCP
1. The client reads a line of characters and sends to server
2. The server receives the data and converts to uppercase
3. The server sends the modified data to the client
4. Client receives the modified data and displayed on screen

![[Pasted image 20251214231624.png]]


**UDPClient.py**
```python
from socket import *
serverName = 'hostname'
serverPort = 12000
clientSocket = socket(AF_INET, SOCK_DGRAM)
message = raw_input('Input lowercase sentence:')
clientSocket.sendto(message.encode(), (serverName, serverPort))
modifiedMessage, serverAddress = clientSocket.recvfrom(2048)
print(modifiedMessage.decode())
clientSocket.close()
```

- Set hostname and port variable names
- Creates a IPv4 UDP docket
- Sends message to destination address


**UDPServer.py**
```python
from socket import *
serverPort = 12000
serverSocket = socket(AF_INET, SOCK_DGRAM)
serverSocket.bind(('', serverPort))
print("The server is ready to receive")
while True:
	message, clientAddress = serverSocket.recvfrom(2048)
	modifiedMessage = message.decode().upper()
	serverSocket.sendto(modifiedMessage.encode(), clientAddress)
```
- Assigned the port number to server's socket
- In while loop, waits for a packet to arrive

### Socket Programming with TCP

- TCP is a connection-oriented protocol
- First handsha

## Summary

